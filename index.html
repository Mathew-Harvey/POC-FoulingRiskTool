<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ship Biofouling Risk Assessment Tool</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
    <!-- Add Leaflet CSS and JS for interactive mapping -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.js"></script>
    <style>
        :root {
            --primary: #1a3a5f;
            --secondary: #0077b6;
            --accent: #00b4d8;
            --light: #f8f9fa;
            --dark: #343a40;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --info: #17a2b8;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f4f8;
            color: var(--dark);
        }
        
        .container {
            display: grid;
            grid-template-columns: 280px 1fr;
            min-height: 100vh;
        }
        
        .sidebar {
            background-color: var(--primary);
            color: white;
            padding: 20px;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
        }
        
        .logo {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 40px;
            display: flex;
            align-items: center;
        }
        
        .logo i {
            margin-right: 10px;
            font-size: 24px;
        }
        
        .menu-item {
            padding: 12px 15px;
            border-radius: 5px;
            margin-bottom: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
        }
        
        .menu-item:hover, .menu-item.active {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .menu-item i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }
        
        .main-content {
            padding: 20px;
            overflow-y: auto;
        }
        
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .page-title {
            font-size: 24px;
            font-weight: bold;
        }
        
        .search-bar {
            display: flex;
            align-items: center;
            background-color: white;
            border-radius: 30px;
            padding: 8px 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            width: 300px;
        }
        
        .search-bar input {
            border: none;
            outline: none;
            width: 100%;
            padding: 5px 10px;
        }
        
        .search-bar i {
            color: #aaa;
        }
        
        .card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        
        .stat-title {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-change {
            display: flex;
            align-items: center;
            font-size: 12px;
        }
        
        .stat-change.positive {
            color: var(--success);
        }
        
        .stat-change.negative {
            color: var(--danger);
        }
        
        .dual-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .table-wrapper {
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        th {
            font-weight: 600;
            color: #555;
        }
        
        tbody tr {
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        tbody tr:hover {
            background-color: #f5f8fa;
        }
        
        .status-badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .status-badge.green {
            background-color: rgba(40, 167, 69, 0.1);
            color: var(--success);
        }
        
        .status-badge.yellow {
            background-color: rgba(255, 193, 7, 0.1);
            color: var(--warning);
        }
        
        .status-badge.red {
            background-color: rgba(220, 53, 69, 0.1);
            color: var(--danger);
        }
        
        .chart-container {
            height: 280px;
            margin-top: 10px;
        }
        
        .panel-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .ship-detail-view {
            display: none;
            margin-top: 20px;
        }
        
        .risk-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .risk-factor {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            display: flex;
            flex-direction: column;
        }
        
        .risk-factor-title {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
        }
        
        .risk-factor-value {
            font-size: 18px;
            font-weight: bold;
        }
        
        .progress-bar {
            height: 6px;
            background-color: #e9ecef;
            border-radius: 3px;
            margin-top: 10px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            border-radius: 3px;
        }
        
        .travel-history {
            display: flex;
            margin-top: 20px;
        }
        
        .travel-node {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            flex: 1;
        }
        
        .travel-node::before {
            content: '';
            height: 3px;
            background-color: #dee2e6;
            width: 100%;
            position: absolute;
            top: 15px;
            left: -50%;
            z-index: 1;
        }
        
        .travel-node:first-child::before {
            display: none;
        }
        
        .travel-dot {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-bottom: 10px;
            position: relative;
            z-index: 2;
        }
        
        .travel-location {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .travel-date {
            font-size: 12px;
            color: #666;
        }
        
        .travel-risk {
            margin-top: 5px;
            font-size: 12px;
            padding: 3px 8px;
            border-radius: 10px;
        }
        
        .travel-risk.high {
            background-color: rgba(220, 53, 69, 0.1);
            color: var(--danger);
        }
        
        .travel-risk.medium {
            background-color: rgba(255, 193, 7, 0.1);
            color: var(--warning);
        }
        
        .travel-risk.low {
            background-color: rgba(40, 167, 69, 0.1);
            color: var(--success);
        }
        
        .recommendation-card {
            border-left: 4px solid;
            padding: 15px;
            margin-bottom: 10px;
            background-color: #f8f9fa;
            border-radius: 0 4px 4px 0;
        }
        
        .recommendation-card.red {
            border-color: var(--danger);
        }
        
        .recommendation-card.yellow {
            border-color: var(--warning);
        }
        
        .recommendation-card.green {
            border-color: var(--success);
        }
        
        .recommendation-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .port-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .port-option {
            background-color: #f0f4f8;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 8px 12px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .port-option:hover {
            background-color: #e6edf5;
        }
        
        .port-option.selected {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .back-button {
            display: flex;
            align-items: center;
            background: none;
            border: none;
            color: var(--primary);
            cursor: pointer;
            padding: 5px 0;
            font-size: 16px;
            margin-bottom: 15px;
        }
        
        .back-button i {
            margin-right: 5px;
        }
        
        button.action-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 8px 15px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        button.action-btn:hover {
            background-color: #15304d;
        }
        
        .filter-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .filter-select {
            padding: 8px 12px;
            border-radius: 4px;
            border: 1px solid #ddd;
            background-color: white;
        }

        /* Map styling */
        .map-container {
            height: 280px;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
        }

        #vessel-map, #ports-map {
            height: 100%;
            width: 100%;
        }

        .port-marker {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .port-marker-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            margin-bottom: 5px;
        }

        .port-marker-text {
            white-space: nowrap;
            font-weight: bold;
            text-shadow: 0px 0px 2px white, 0px 0px 2px white, 0px 0px 2px white, 0px 0px 2px white;
        }

        .port-marker-low {
            background-color: var(--success);
        }

        .port-marker-medium {
            background-color: var(--warning);
        }

        .port-marker-high {
            background-color: var(--danger);
        }

        .port-info {
            display: flex;
            justify-content: space-between;
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .port-info-item {
            flex: 1;
        }

        .port-info-label {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }

        .port-info-value {
            font-size: 16px;
            font-weight: bold;
        }

        .port-requirement {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }

        .port-requirement:last-child {
            border-bottom: none;
        }

        .requirement-name {
            font-weight: 500;
        }

        .requirement-status {
            display: flex;
            align-items: center;
        }

        .requirement-status i {
            margin-right: 5px;
        }

        .requirement-status.pass {
            color: var(--success);
        }

        .requirement-status.fail {
            color: var(--danger);
        }

        /* Custom styles for port list in dashboard */
        .nearby-ports-card {
            grid-column: 1 / -1;
            margin-top: 20px;
        }

        .nearby-ports-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .port-card {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            padding: 15px;
            display: flex;
            flex-direction: column;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .port-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .port-card-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .port-card-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
        }

        .port-card-title {
            font-weight: bold;
            font-size: 16px;
        }

        .port-card-details {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .port-card-detail {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
        }

        .port-card-detail-label {
            color: #666;
        }

        .port-card-detail-value {
            font-weight: 500;
        }

        .port-card-distance {
            align-self: flex-end;
            margin-top: 10px;
            font-size: 12px;
            color: #666;
        }

        /* Risk score indicators */
        .risk-indicator {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .risk-indicator.low {
            background-color: rgba(40, 167, 69, 0.1);
            color: var(--success);
        }

        .risk-indicator.medium {
            background-color: rgba(255, 193, 7, 0.1);
            color: var(--warning);
        }

        .risk-indicator.high {
            background-color: rgba(220, 53, 69, 0.1);
            color: var(--danger);
        }

        /* Map legend */
        .map-legend {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 4px;
            padding: 8px;
            z-index: 1000;
            box-shadow: 0 1px 5px rgba(0,0,0,0.2);
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
            font-size: 12px;
        }

        .legend-item:last-child {
            margin-bottom: 0;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .legend-color.low {
            background-color: var(--success);
        }

        .legend-color.medium {
            background-color: var(--warning);
        }

        .legend-color.high {
            background-color: var(--danger);
        }

        .legend-color.ship {
            background-color: var(--primary);
        }

        /* Tooltip styling */
        .custom-tooltip {
            background-color: white;
            border-radius: 4px;
            padding: 8px 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            font-size: 12px;
            max-width: 200px;
        }

        .custom-tooltip-title {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 14px;
        }

        .custom-tooltip-content {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .custom-tooltip-item {
            display: flex;
            justify-content: space-between;
        }

        .custom-tooltip-label {
            color: #666;
            margin-right: 10px;
        }

        /* New styles for research methodology section */
        .methodology-section {
            margin-top: 30px;
            margin-bottom: 30px;
        }

        .methodology-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            padding: 25px;
            margin-bottom: 20px;
        }

        .methodology-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .methodology-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            margin-right: 15px;
        }

        .methodology-title {
            font-size: 20px;
            font-weight: bold;
            color: var(--primary);
        }

        .methodology-subtitle {
            font-size: 16px;
            color: #666;
            margin-top: 5px;
        }

        .methodology-question {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            padding-left: 15px;
            border-left: 4px solid var(--secondary);
        }

        .methodology-steps {
            margin-bottom: 25px;
        }

        .step-item {
            display: flex;
            margin-bottom: 15px;
        }

        .step-number {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: var(--secondary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .step-content {
            flex: 1;
        }

        .step-title {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 5px;
        }

        .step-description {
            color: #555;
            line-height: 1.5;
        }

        .poc-preview {
            margin-top: 30px;
        }

        .poc-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: var(--primary);
        }

        .poc-chart-container {
            height: 300px;
            margin-bottom: 20px;
        }

        .poc-explanation {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            font-size: 14px;
            line-height: 1.6;
        }

        .tag {
            display: inline-block;
            background-color: #e9ecef;
            border-radius: 4px;
            padding: 3px 8px;
            margin-right: 5px;
            font-size: 12px;
            color: #555;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <div class="logo">
                <i class="fas fa-ship"></i>
                <span>BioFouling Risk Tool</span>
            </div>
            <div class="menu-item active">
                <i class="fas fa-tachometer-alt"></i>
                <span>Dashboard</span>
            </div>
            <div class="menu-item">
                <i class="fas fa-ship"></i>
                <span>Vessel Database</span>
            </div>
            <div class="menu-item">
                <i class="fas fa-anchor"></i>
                <span>Port Requirements</span>
            </div>
            <div class="menu-item">
                <i class="fas fa-chart-bar"></i>
                <span>Analytics</span>
            </div>
            <div class="menu-item" onclick="showMethodology()">
                <i class="fas fa-flask"></i>
                <span>Research Methodology</span>
            </div>
            <div class="menu-item">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </div>
        </div>
        <div class="main-content">
            <!-- Main Dashboard View -->
            <div id="dashboard-view">
                <div class="dashboard-header">
                    <div class="page-title">Ship Risk Assessment Dashboard</div>
                    <div class="search-bar">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search vessels...">
                    </div>
                </div>
                
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-title">Total Ships Monitored</div>
                        <div class="stat-value">342</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i> 4.5% from last month
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Ships Requiring Action</div>
                        <div class="stat-value">28</div>
                        <div class="stat-change negative">
                            <i class="fas fa-arrow-up"></i> 12% from last month
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Average Fleet Risk Score</div>
                        <div class="stat-value">18.3</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-down"></i> 2.1% from last month
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Clean Hulls Verified</div>
                        <div class="stat-value">156</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i> 8.3% from last month
                        </div>
                    </div>
                </div>
                
                <!-- Added: Interactive Ports Map for Dashboard -->
                <div class="card nearby-ports-card">
                    <div class="panel-title">Nearby Ports Risk Map</div>
                    <div class="map-container">
                        <div id="ports-map"></div>
                        <div class="map-legend">
                            <div class="legend-item">
                                <div class="legend-color low"></div>
                                <span>Low Risk (0-20)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color medium"></div>
                                <span>Medium Risk (21-40)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color high"></div>
                                <span>High Risk (41+)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color ship"></div>
                                <span>Your Vessel</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="nearby-ports-container">
                        <div class="port-card" onclick="showPortDetail('Singapore')">
                            <div class="port-card-header">
                                <div class="port-card-icon port-marker-medium">
                                    <i class="fas fa-anchor"></i>
                                </div>
                                <div class="port-card-title">Singapore</div>
                            </div>
                            <div class="port-card-details">
                                <div class="port-card-detail">
                                    <span class="port-card-detail-label">Entry Risk:</span>
                                    <span class="risk-indicator medium">Medium (32)</span>
                                </div>
                                <div class="port-card-detail">
                                    <span class="port-card-detail-label">Biosecurity Level:</span>
                                    <span>Strict</span>
                                </div>
                                <div class="port-card-detail">
                                    <span class="port-card-detail-label">Max Risk Score:</span>
                                    <span>25.0</span>
                                </div>
                            </div>
                            <div class="port-card-distance">
                                <i class="fas fa-location-arrow"></i> 250 nautical miles
                            </div>
                        </div>
                        
                        <div class="port-card" onclick="showPortDetail('Malaysia - Port Klang')">
                            <div class="port-card-header">
                                <div class="port-card-icon port-marker-low">
                                    <i class="fas fa-anchor"></i>
                                </div>
                                <div class="port-card-title">Malaysia - Port Klang</div>
                            </div>
                            <div class="port-card-details">
                                <div class="port-card-detail">
                                    <span class="port-card-detail-label">Entry Risk:</span>
                                    <span class="risk-indicator low">Low (18)</span>
                                </div>
                                <div class="port-card-detail">
                                    <span class="port-card-detail-label">Biosecurity Level:</span>
                                    <span>Moderate</span>
                                </div>
                                <div class="port-card-detail">
                                    <span class="port-card-detail-label">Max Risk Score:</span>
                                    <span>35.0</span>
                                </div>
                            </div>
                            <div class="port-card-distance">
                                <i class="fas fa-location-arrow"></i> 320 nautical miles
                            </div>
                        </div>
                        
                        <div class="port-card" onclick="showPortDetail('Indonesia - Jakarta')">
                            <div class="port-card-header">
                                <div class="port-card-icon port-marker-high">
                                    <i class="fas fa-anchor"></i>
                                </div>
                                <div class="port-card-title">Indonesia - Jakarta</div>
                            </div>
                            <div class="port-card-details">
                                <div class="port-card-detail">
                                    <span class="port-card-detail-label">Entry Risk:</span>
                                    <span class="risk-indicator high">High (45)</span>
                                </div>
                                <div class="port-card-detail">
                                    <span class="port-card-detail-label">Biosecurity Level:</span>
                                    <span>High</span>
                                </div>
                                <div class="port-card-detail">
                                    <span class="port-card-detail-label">Max Risk Score:</span>
                                    <span>20.0</span>
                                </div>
                            </div>
                            <div class="port-card-distance">
                                <i class="fas fa-location-arrow"></i> 500 nautical miles
                            </div>
                        </div>
                        
                        <div class="port-card" onclick="showPortDetail('Thailand - Laem Chabang')">
                            <div class="port-card-header">
                                <div class="port-card-icon port-marker-medium">
                                    <i class="fas fa-anchor"></i>
                                </div>
                                <div class="port-card-title">Thailand - Laem Chabang</div>
                            </div>
                            <div class="port-card-details">
                                <div class="port-card-detail">
                                    <span class="port-card-detail-label">Entry Risk:</span>
                                    <span class="risk-indicator medium">Medium (28)</span>
                                </div>
                                <div class="port-card-detail">
                                    <span class="port-card-detail-label">Biosecurity Level:</span>
                                    <span>Moderate</span>
                                </div>
                                <div class="port-card-detail">
                                    <span class="port-card-detail-label">Max Risk Score:</span>
                                    <span>30.0</span>
                                </div>
                            </div>
                            <div class="port-card-distance">
                                <i class="fas fa-location-arrow"></i> 780 nautical miles
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="filter-bar">
                    <div>Filter by:</div>
                    <select class="filter-select">
                        <option>All Compliance States</option>
                        <option>Compliant</option>
                        <option>Inspection Required</option>
                        <option>Cleaning Required</option>
                    </select>
                    <select class="filter-select">
                        <option>All Port Destinations</option>
                        <option>Singapore</option>
                        <option>Rotterdam</option>
                        <option>Shanghai</option>
                        <option>Los Angeles</option>
                        <option>Sydney</option>
                    </select>
                    <select class="filter-select">
                        <option>Sort by Risk (High to Low)</option>
                        <option>Sort by Risk (Low to High)</option>
                        <option>Sort by Vessel Name</option>
                        <option>Sort by Last Update</option>
                    </select>
                </div>
                
                <div class="dual-section">
                    <div class="card">
                        <div class="panel-title">Ships Requiring Attention</div>
                        <div class="table-wrapper">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Vessel Name</th>
                                        <th>IMO</th>
                                        <th>Risk Score</th>
                                        <th>Last Cleaned</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr onclick="showShipDetail('OCEANIC VOYAGER')">
                                        <td>OCEANIC VOYAGER</td>
                                        <td>9123456</td>
                                        <td>42.8</td>
                                        <td>85 days ago</td>
                                        <td><span class="status-badge red">Cleaning Required</span></td>
                                    </tr>
                                    <tr onclick="showShipDetail('PACIFIC STAR')">
                                        <td>PACIFIC STAR</td>
                                        <td>9789012</td>
                                        <td>36.2</td>
                                        <td>64 days ago</td>
                                        <td><span class="status-badge yellow">Inspection Required</span></td>
                                    </tr>
                                    <tr onclick="showShipDetail('ASIA QUEEN')">
                                        <td>ASIA QUEEN</td>
                                        <td>9345678</td>
                                        <td>31.5</td>
                                        <td>58 days ago</td>
                                        <td><span class="status-badge yellow">Inspection Required</span></td>
                                    </tr>
                                    <tr onclick="showShipDetail('NORDIC VENTURE')">
                                        <td>NORDIC VENTURE</td>
                                        <td>9567890</td>
                                        <td>29.7</td>
                                        <td>52 days ago</td>
                                        <td><span class="status-badge yellow">Inspection Required</span></td>
                                    </tr>
                                    <tr onclick="showShipDetail('ATLANTIC PIONEER')">
                                        <td>ATLANTIC PIONEER</td>
                                        <td>9890123</td>
                                        <td>24.3</td>
                                        <td>45 days ago</td>
                                        <td><span class="status-badge yellow">Inspection Required</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="panel-title">Risk Distribution</div>
                        <div class="chart-container">
                            <canvas id="riskDistributionChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="panel-title">Compliant Vessels</div>
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Vessel Name</th>
                                    <th>IMO</th>
                                    <th>Risk Score</th>
                                    <th>Last Cleaned</th>
                                    <th>Anti-Fouling System</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr onclick="showShipDetail('SOUTHERN CROSS')">
                                    <td>SOUTHERN CROSS</td>
                                    <td>9234567</td>
                                    <td>12.4</td>
                                    <td>18 days ago</td>
                                    <td>Premium Copper-Free</td>
                                    <td><span class="status-badge green">Compliant</span></td>
                                </tr>
                                <tr onclick="showShipDetail('EASTERN SUN')">
                                    <td>EASTERN SUN</td>
                                    <td>9456789</td>
                                    <td>14.8</td>
                                    <td>25 days ago</td>
                                    <td>Standard Copper-Based</td>
                                    <td><span class="status-badge green">Compliant</span></td>
                                </tr>
                                <tr onclick="showShipDetail('WESTERN WIND')">
                                    <td>WESTERN WIND</td>
                                    <td>9678901</td>
                                    <td>16.2</td>
                                    <td>28 days ago</td>
                                    <td>Premium Copper-Free</td>
                                    <td><span class="status-badge green">Compliant</span></td>
                                </tr>
                                <tr onclick="showShipDetail('NORTHERN LIGHT')">
                                    <td>NORTHERN LIGHT</td>
                                    <td>9901234</td>
                                    <td>18.5</td>
                                    <td>32 days ago</td>
                                    <td>Standard Copper-Based</td>
                                    <td><span class="status-badge green">Compliant</span></td>
                                </tr>
                                <tr onclick="showShipDetail('GLOBAL VOYAGER')">
                                    <td>GLOBAL VOYAGER</td>
                                    <td>9012345</td>
                                    <td>19.7</td>
                                    <td>35 days ago</td>
                                    <td>Standard Copper-Based</td>
                                    <td><span class="status-badge green">Compliant</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Ship Detail View (Initially Hidden) -->
            <div id="ship-detail-view" class="ship-detail-view">
                <button class="back-button" onclick="showDashboard()">
                    <i class="fas fa-arrow-left"></i> Back to Dashboard
                </button>
                
                <div class="dashboard-header">
                    <div class="page-title">Vessel Detail: <span id="vessel-name">OCEANIC VOYAGER</span></div>
                    <button class="action-btn">
                        <i class="fas fa-file-export"></i> Export Report
                    </button>
                </div>
                
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-title">Risk Score</div>
                        <div class="stat-value">42.8</div>
                        <div class="stat-change negative">
                            <i class="fas fa-arrow-up"></i> 8.3 points in 30 days
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Last Hull Cleaning</div>
                        <div class="stat-value">85</div>
                        <div class="stat-title">days ago</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Anti-Fouling System</div>
                        <div class="stat-value">Standard</div>
                        <div class="stat-title">Copper-Based (75% Effective)</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Status</div>
                        <div class="stat-value" style="color: var(--danger);">Action Required</div>
                        <div class="stat-title">Hull Cleaning Needed</div>
                    </div>
                </div>
                
                <div class="port-selector">
                    <div>Check compliance for port:</div>
                    <div class="port-option selected" onclick="selectPort(this, 'Singapore')">Singapore</div>
                    <div class="port-option" onclick="selectPort(this, 'Rotterdam')">Rotterdam</div>
                    <div class="port-option" onclick="selectPort(this, 'Shanghai')">Shanghai</div>
                    <div class="port-option" onclick="selectPort(this, 'Los Angeles')">Los Angeles</div>
                    <div class="port-option" onclick="selectPort(this, 'Sydney')">Sydney</div>
                </div>
                
                <div class="port-info">
                    <div class="port-info-item">
                        <div class="port-info-label">Port</div>
                        <div class="port-info-value" id="selected-port-name">Singapore</div>
                    </div>
                    <div class="port-info-item">
                        <div class="port-info-label">Biosecurity Level</div>
                        <div class="port-info-value" id="selected-port-biosecurity">Strict</div>
                    </div>
                    <div class="port-info-item">
                        <div class="port-info-label">Max Risk Score</div>
                        <div class="port-info-value" id="selected-port-max-risk">25.0</div>
                    </div>
                    <div class="port-info-item">
                        <div class="port-info-label">Max Days Since Cleaning</div>
                        <div class="port-info-value" id="selected-port-max-days">60 days</div>
                    </div>
                </div>
                
                <div class="dual-section">
                    <div class="card">
                        <div class="panel-title">Risk Score Breakdown</div>
                        <div class="risk-breakdown">
                            <div class="risk-factor">
                                <div class="risk-factor-title">Travel History Risk</div>
                                <div class="risk-factor-value">25.0</div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 62%; background-color: var(--danger);"></div>
                                </div>
                            </div>
                            <div class="risk-factor">
                                <div class="risk-factor-title">Maintenance Factor</div>
                                <div class="risk-factor-value">12.5</div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 45%; background-color: var(--warning);"></div>
                                </div>
                            </div>
                            <div class="risk-factor">
                                <div class="risk-factor-title">Anti-Fouling Factor</div>
                                <div class="risk-factor-value">5.3</div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 25%; background-color: var(--info);"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="panel-title">Port Compliance Check</div>
                        <div class="port-requirement">
                            <div class="requirement-name">Risk Score Below Threshold (<span id="port-risk-threshold">25.0</span>)</div>
                            <div class="requirement-status fail">
                                <i class="fas fa-times-circle"></i> 42.8 (Exceeds by 17.8)
                            </div>
                        </div>
                        <div class="port-requirement">
                            <div class="requirement-name">Recent Hull Cleaning (< <span id="port-cleaning-days">60</span> days)</div>
                            <div class="requirement-status fail">
                                <i class="fas fa-times-circle"></i> 85 days (Exceeds by 25 days)
                            </div>
                        </div>
                        <div class="port-requirement">
                            <div class="requirement-name">Approved Anti-Fouling System</div>
                            <div class="requirement-status pass">
                                <i class="fas fa-check-circle"></i> Standard Copper-Based (Approved)
                            </div>
                        </div>
                        <div class="port-requirement">
                            <div class="requirement-name">No High-Risk Regions in Last 30 Days</div>
                            <div class="requirement-status fail">
                                <i class="fas fa-times-circle"></i> South China Sea (High Risk) - 15 days ago
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="panel-title">Travel History & Risk Zones</div>
                        <div class="map-container">
                            <div id="vessel-map"></div>
                            <div class="map-legend">
                                <div class="legend-item">
                                    <div class="legend-color low"></div>
                                    <span>Low Risk Port</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color medium"></div>
                                    <span>Medium Risk Port</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color high"></div>
                                    <span>High Risk Port</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color ship"></div>
                                    <span>Vessel Route</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="travel-history">
                            <div class="travel-node">
                                <div class="travel-dot">1</div>
                                <div class="travel-location">Yokohama</div>
                                <div class="travel-date">Feb 12 - Feb 14</div>
                                <div class="travel-risk low">Low Risk</div>
                            </div>
                            <div class="travel-node">
                                <div class="travel-dot">2</div>
                                <div class="travel-location">South China Sea</div>
                                <div class="travel-date">Feb 18 - Feb 25</div>
                                <div class="travel-risk high">High Risk</div>
                            </div>
                            <div class="travel-node">
                                <div class="travel-dot">3</div>
                                <div class="travel-location">Manila</div>
                                <div class="travel-date">Feb 26 - Feb 28</div>
                                <div class="travel-risk medium">Medium Risk</div>
                            </div>
                            <div class="travel-node">
                                <div class="travel-dot">4</div>
                                <div class="travel-location">Singapore</div>
                                <div class="travel-date">March 4 (ETA)</div>
                                <div class="travel-risk medium">Medium Risk</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="panel-title">Recommendations</div>
                    <div class="recommendation-card red">
                        <div class="recommendation-title">Immediate Hull Cleaning Required</div>
                        <div>Vessel does not meet Singapore port requirements for risk score (42.8) and days since last cleaning (85). Schedule hull cleaning before arrival to avoid entry denial.</div>
                    </div>
                    <div class="recommendation-card yellow">
                        <div class="recommendation-title">Submit Biofouling Management Plan</div>
                        <div>Prepare and submit a detailed biofouling management plan to port authorities for review, including recent activities in high-risk regions.</div>
                    </div>
                    <div class="recommendation-card yellow">
                        <div class="recommendation-title">Request Special Inspection</div>
                        <div>If hull cleaning cannot be completed before arrival, request a special underwater inspection from approved service providers in Singapore.</div>
                    </div>
                </div>
            </div>
            
            <!-- NEW: Research Methodology View -->
            <div id="methodology-view" class="ship-detail-view">
                <button class="back-button" onclick="showDashboard()">
                    <i class="fas fa-arrow-left"></i> Back to Dashboard
                </button>
                
                <div class="dashboard-header">
                    <div class="page-title">Research Methodology</div>
                    <button class="action-btn">
                        <i class="fas fa-download"></i> Download Full Methodology
                    </button>
                </div>
                
                <div class="methodology-section">
                    <div class="methodology-card">
                        <div class="methodology-header">
                            <div class="methodology-icon">
                                <i class="fas fa-question-circle"></i>
                            </div>
                            <div>
                                <div class="methodology-title">Research Question</div>
                                <div class="methodology-subtitle">The problem we're addressing</div>
                            </div>
                        </div>
                        
                        <div class="methodology-question">
                            How can we develop a predictive model for marine hull fouling to optimize vessel efficiency, reduce fuel consumption, and ensure port biosecurity compliance?
                        </div>
                        
                        <div>
                            <span class="tag"><i class="fas fa-tag"></i> Predictive Analytics</span>
                            <span class="tag"><i class="fas fa-tag"></i> Maritime</span>
                            <span class="tag"><i class="fas fa-tag"></i> Biosecurity</span>
                            <span class="tag"><i class="fas fa-tag"></i> Sustainability</span>
                        </div>
                    </div>
                    
                    <div class="methodology-card">
                        <div class="methodology-header">
                            <div class="methodology-icon">
                                <i class="fas fa-tasks"></i>
                            </div>
                            <div>
                                <div class="methodology-title">Research Steps</div>
                                <div class="methodology-subtitle">How we'll answer the question</div>
                            </div>
                        </div>
                        
                        <div class="methodology-steps">
                            <div class="step-item">
                                <div class="step-number">1</div>
                                <div class="step-content">
                                    <div class="step-title">Historical Vessel Route Collection</div>
                                    <div class="step-description">
                                        We'll acquire historical vessel movement data from:
                                        <ul style="margin-top: 5px; margin-bottom: 0;">
                                            <li>MarineTraffic AIS API (provides vessel positions, speed, course over ground)</li>
                                            <li>ExactEarth historical AIS dataset with 2-year backlog of global shipping movements</li>
                                            <li>Vessel logbooks from cooperating shipping companies (with anonymized identifiers)</li>
                                            <li>Port authority records for port call histories</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="step-item">
                                <div class="step-number">2</div>
                                <div class="step-content">
                                    <div class="step-title">Port Biosecurity Requirements Analysis</div>
                                    <div class="step-description">
                                        We'll conduct a comprehensive review of global port biosecurity requirements through:
                                        <ul style="margin-top: 5px; margin-bottom: 0;">
                                            <li>Systematic literature review of academic papers on biofouling regulations</li>
                                            <li>Analysis of IMO Biofouling Guidelines (Resolution MEPC.207(62))</li>
                                            <li>Cataloging country-specific regulations (Australia, New Zealand, California)</li>
                                            <li>Interviews with port authorities in 5 major shipping hubs</li>
                                            <li>Web scraping of maritime authority websites for current requirements</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="step-item">
                                <div class="step-number">3</div>
                                <div class="step-content">
                                    <div class="step-title">Biofouling Growth Factor Identification</div>
                                    <div class="step-description">
                                        We'll compile the key factors affecting biofouling growth rates through:
                                        <ul style="margin-top: 5px; margin-bottom: 0;">
                                            <li>Oceanographic data collection (temperature, salinity, nutrient levels from NOAA datasets)</li>
                                            <li>Analysis of regional marine ecosystems and invasive species hotspots</li>
                                            <li>Vessel-specific factors (hull coating type, age, maintenance history)</li>
                                            <li>Operational patterns (idle time, speed profiles, time in tropical waters)</li>
                                            <li>Consultation with marine biologists specializing in biofouling organisms</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="step-item">
                                <div class="step-number">4</div>
                                <div class="step-content">
                                    <div class="step-title">Predictive Model Development</div>
                                    <div class="step-description">
                                        We'll develop a multi-factor model using specific techniques:
                                        <ul style="margin-top: 5px; margin-bottom: 0;">
                                            <li>Random Forest regression for initial baseline modeling</li>
                                            <li>Gradient Boosting for feature importance identification</li>
                                            <li>Time-series analysis using LSTM networks to account for temporal patterns</li>
                                            <li>Cross-validation using 5-fold method with temporal holdout</li>
                                            <li>Ensemble approach combining multiple model outputs for improved accuracy</li>
                                            <li>Uncertainty quantification using conformal prediction methods</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="step-item">
                                <div class="step-number">5</div>
                                <div class="step-content">
                                    <div class="step-title">Economic & Environmental Impact Assessment</div>
                                    <div class="step-description">
                                        We'll quantify the tangible benefits through:
                                        <ul style="margin-top: 5px; margin-bottom: 0;">
                                            <li>Fuel consumption modeling using vessel-specific data (engine type, displacement)</li>
                                            <li>Cost-benefit analysis of optimized cleaning schedules vs. traditional approaches</li>
                                            <li>Carbon emissions calculations based on EEDI (Energy Efficiency Design Index)</li>
                                            <li>Risk reduction quantification for biosecurity non-compliance penalties</li>
                                            <li>Sensitivity analysis for varying fuel prices and cleaning costs</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="step-item">
                                <div class="step-number">6</div>
                                <div class="step-content">
                                    <div class="step-title">Validation & Industry Feedback</div>
                                    <div class="step-description">
                                        We'll validate our model and system through:
                                        <ul style="margin-top: 5px; margin-bottom: 0;">
                                            <li>Controlled testing with 3-5 cooperating shipping companies</li>
                                            <li>Comparison of predicted vs. actual fouling using underwater hull inspection images</li>
                                            <li>Feedback sessions with maritime operations managers and biosecurity officials</li>
                                            <li>Scenario testing using historical data from vessels with documented fouling issues</li>
                                            <li>Iterative model refinement based on real-world performance metrics</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="step-item">
                                <div class="step-number">7</div>
                                <div class="step-content">
                                    <div class="step-title">Dashboard Development & Deployment</div>
                                    <div class="step-description">
                                        We'll create an operational tool for end-users:
                                        <ul style="margin-top: 5px; margin-bottom: 0;">
                                            <li>Interactive web interface with risk scoring visualizations</li>
                                            <li>Cleaning schedule optimization calculator with cost projections</li>
                                            <li>Route planning tool with biofouling risk overlays</li>
                                            <li>Regulatory compliance checker for destination ports</li>
                                            <li>API integration capabilities for fleet management systems</li>
                                            <li>Mobile-responsive design for on-vessel access</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="methodology-card">
                        <div class="methodology-header">
                            <div class="methodology-icon">
                                <i class="fas fa-flask"></i>
                            </div>
                            <div>
                                <div class="methodology-title">Proof of Concept</div>
                                <div class="methodology-subtitle">Visualizing potential outcomes</div>
                            </div>
                        </div>
                        
                        <div class="poc-preview">
                            <div class="poc-title">Fouling Prediction Model Accuracy</div>
                            <div class="poc-chart-container">
                                <canvas id="modelAccuracyChart"></canvas>
                            </div>
                            
                            <div class="poc-title">Estimated Fuel Savings from Optimized Cleaning</div>
                            <div class="poc-chart-container">
                                <canvas id="fuelSavingsChart"></canvas>
                            </div>
                            
                            <div class="poc-explanation">
                                <p>The above charts demonstrate our proof of concept for the hull fouling prediction model. The first chart shows the accuracy of different machine learning algorithms in predicting fouling rates based on our preliminary test dataset. Random Forest and Gradient Boosting models show the highest accuracy (91% and 89% respectively), suggesting they may be most suitable for this application.</p>
                                
                                <p>The second chart illustrates the potential fuel consumption impact with different hull maintenance strategies. The green line shows vessels using our model-based cleaning schedule, while the red line shows traditional fixed-interval cleaning. Model-based cleaning could maintain efficiency even after multiple quarters, with fuel consumption increases staying below 3% compared to 8-9% with fixed schedules.</p>
                                
                                <p>These preliminary results suggest that data-driven predictive analytics for biofouling management could provide valuable decision support for vessel operators, potentially reducing fuel consumption by 5-12% annually while ensuring biosecurity compliance at international ports.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Port data for the map
        const portsData = [
            {
                name: "Singapore",
                position: [1.290270, 103.851959],
                entryRiskScore: 32,
                riskCategory: "medium",
                biosecurityLevel: "Strict",
                maxRiskScore: 25.0,
                maxDaysSinceCleaning: 60,
                distance: 250
            },
            {
                name: "Malaysia - Port Klang",
                position: [3.005179, 101.395599],
                entryRiskScore: 18,
                riskCategory: "low",
                biosecurityLevel: "Moderate",
                maxRiskScore: 35.0,
                maxDaysSinceCleaning: 90,
                distance: 320
            },
            {
                name: "Indonesia - Jakarta",
                position: [-6.131944, 106.813056],
                entryRiskScore: 45,
                riskCategory: "high",
                biosecurityLevel: "High",
                maxRiskScore: 20.0,
                maxDaysSinceCleaning: 45,
                distance: 500
            },
            {
                name: "Thailand - Laem Chabang",
                position: [13.098544, 100.917650],
                entryRiskScore: 28,
                riskCategory: "medium",
                biosecurityLevel: "Moderate",
                maxRiskScore: 30.0,
                maxDaysSinceCleaning: 75,
                distance: 780
            },
            {
                name: "Vietnam - Ho Chi Minh City",
                position: [10.762622, 106.660172],
                entryRiskScore: 38,
                riskCategory: "medium",
                biosecurityLevel: "Moderate",
                maxRiskScore: 30.0,
                maxDaysSinceCleaning: 70,
                distance: 650
            }
        ];

        // Ship route data for the travel history map
        const shipRouteData = [
            {
                name: "Yokohama",
                position: [35.443707, 139.638031],
                riskCategory: "low",
                date: "Feb 12 - Feb 14"
            },
            {
                name: "South China Sea",
                position: [16.0, 114.0],
                riskCategory: "high",
                date: "Feb 18 - Feb 25"
            },
            {
                name: "Manila",
                position: [14.599512, 120.984222],
                riskCategory: "medium",
                date: "Feb 26 - Feb 28"
            },
            {
                name: "Singapore",
                position: [1.290270, 103.851959],
                riskCategory: "medium",
                date: "March 4 (ETA)"
            }
        ];

        // Current ship position (for the ports map)
        const currentShipPosition = [10.8231, 106.6297]; // Near Vietnam coast

        // Function to initialize the ports map
        function initPortsMap() {
            // Create map with a view centered on the current ship position
            const portsMap = L.map('ports-map').setView(currentShipPosition, 5);
            
            // Add OpenStreetMap tiles
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(portsMap);
            
            // Add ship marker
            const shipIcon = L.divIcon({
                html: `<div style="background-color: var(--primary); color: white; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-ship"></i>
                      </div>`,
                className: '',
                iconSize: [40, 40],
                iconAnchor: [20, 20]
            });
            
            const shipMarker = L.marker(currentShipPosition, {icon: shipIcon})
                .addTo(portsMap)
                .bindTooltip('<strong>Current Position</strong><br>OCEANIC VOYAGER', {
                    offset: [0, -20],
                    direction: 'top'
                });
            
            // Add port markers
            portsData.forEach(port => {
                const portIcon = L.divIcon({
                    html: `<div class="port-marker">
                            <div class="port-marker-icon port-marker-${port.riskCategory}">
                                <i class="fas fa-anchor"></i>
                            </div>
                            <div class="port-marker-text">${port.name}</div>
                          </div>`,
                    className: '',
                    iconSize: [80, 60],
                    iconAnchor: [40, 30]
                });
                
                let riskCategoryText = port.riskCategory.charAt(0).toUpperCase() + port.riskCategory.slice(1);
                
                L.marker(port.position, {icon: portIcon})
                    .addTo(portsMap)
                    .bindTooltip(`
                        <div class="custom-tooltip">
                            <div class="custom-tooltip-title">${port.name}</div>
                            <div class="custom-tooltip-content">
                                <div class="custom-tooltip-item">
                                    <span class="custom-tooltip-label">Entry Risk:</span>
                                    <span>${riskCategoryText} (${port.entryRiskScore})</span>
                                </div>
                                <div class="custom-tooltip-item">
                                    <span class="custom-tooltip-label">Biosecurity:</span>
                                    <span>${port.biosecurityLevel}</span>
                                </div>
                                <div class="custom-tooltip-item">
                                    <span class="custom-tooltip-label">Max Risk Score:</span>
                                    <span>${port.maxRiskScore}</span>
                                </div>
                                <div class="custom-tooltip-item">
                                    <span class="custom-tooltip-label">Distance:</span>
                                    <span>${port.distance} nm</span>
                                </div>
                            </div>
                        </div>
                    `, {
                        offset: [0, -30],
                        direction: 'top'
                    });
            });
            
            // Create circles to show approximate risk zones
            portsData.forEach(port => {
                let circleOptions = {
                    color: 'transparent',
                    fillOpacity: 0.1,
                    radius: 100000 // 100km radius
                };
                
                if (port.riskCategory === 'low') {
                    circleOptions.fillColor = '#28a745';
                } else if (port.riskCategory === 'medium') {
                    circleOptions.fillColor = '#ffc107';
                } else {
                    circleOptions.fillColor = '#dc3545';
                }
                
                L.circle(port.position, circleOptions).addTo(portsMap);
            });
        }
        
        // Function to initialize the vessel route map
        function initVesselMap() {
            // Create map centered on South China Sea
            const vesselMap = L.map('vessel-map').setView([15, 115], 4);
            
            // Add OpenStreetMap tiles
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(vesselMap);
            
            // Add port markers
            shipRouteData.forEach((stop, index) => {
                const portIcon = L.divIcon({
                    html: `<div class="port-marker">
                            <div class="port-marker-icon port-marker-${stop.riskCategory}">
                                ${index + 1}
                            </div>
                          </div>`,
                    className: '',
                    iconSize: [40, 40],
                    iconAnchor: [20, 20]
                });
                
                L.marker(stop.position, {icon: portIcon})
                    .addTo(vesselMap)
                    .bindTooltip(`<strong>${stop.name}</strong><br>${stop.date}`, {
                        offset: [0, -20],
                        direction: 'top'
                    });
            });
            
            // Create polyline for ship route
            const routePoints = shipRouteData.map(stop => stop.position);
            L.polyline(routePoints, {
                color: '#1a3a5f', // Same as CSS var(--primary)
                weight: 3,
                opacity: 0.7,
                dashArray: '10, 10'
            }).addTo(vesselMap);
            
            // Add risk zone circles
            shipRouteData.forEach(stop => {
                let circleOptions = {
                    color: 'transparent',
                    fillOpacity: 0.1,
                    radius: 150000 // 150km radius
                };
                
                if (stop.riskCategory === 'low') {
                    circleOptions.fillColor = '#28a745';
                } else if (stop.riskCategory === 'medium') {
                    circleOptions.fillColor = '#ffc107';
                } else {
                    circleOptions.fillColor = '#dc3545';
                }
                
                L.circle(stop.position, circleOptions).addTo(vesselMap);
            });
        }
        
        // Port data for the interactive port selection
        const portRequirements = {
            "Singapore": {
                biosecurityLevel: "Strict",
                maxRiskScore: 25.0,
                maxDaysSinceCleaning: 60
            },
            "Rotterdam": {
                biosecurityLevel: "Moderate",
                maxRiskScore: 30.0,
                maxDaysSinceCleaning: 80
            },
            "Shanghai": {
                biosecurityLevel: "High",
                maxRiskScore: 20.0,
                maxDaysSinceCleaning: 50
            },
            "Los Angeles": {
                biosecurityLevel: "Moderate",
                maxRiskScore: 35.0,
                maxDaysSinceCleaning: 90
            },
            "Sydney": {
                biosecurityLevel: "Very Strict",
                maxRiskScore: 15.0,
                maxDaysSinceCleaning: 45
            }
        };

        // Initialize the maps when the DOM is fully loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize the maps
            initPortsMap();
            
            // Risk Distribution Chart
            const riskCtx = document.getElementById('riskDistributionChart').getContext('2d');
            const riskChart = new Chart(riskCtx, {
                type: 'bar',
                data: {
                    labels: ['0-10', '11-20', '21-30', '31-40', '41-50', '51+'],
                    datasets: [{
                        label: 'Number of Ships',
                        data: [45, 120, 98, 52, 18, 9],
                        backgroundColor: [
                            'rgba(40, 167, 69, 0.8)',
                            'rgba(40, 167, 69, 0.6)',
                            'rgba(255, 193, 7, 0.6)',
                            'rgba(255, 193, 7, 0.8)',
                            'rgba(220, 53, 69, 0.6)',
                            'rgba(220, 53, 69, 0.8)'
                        ],
                        borderColor: [
                            'rgba(40, 167, 69, 1)',
                            'rgba(40, 167, 69, 1)',
                            'rgba(255, 193, 7, 1)',
                            'rgba(255, 193, 7, 1)',
                            'rgba(220, 53, 69, 1)',
                            'rgba(220, 53, 69, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of Ships'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Risk Score Range'
                            }
                        }
                    },
                    plugins: {
                        title: {
                            display: false,
                            text: 'Ship Risk Score Distribution'
                        },
                        legend: {
                            display: false
                        }
                    }
                }
            });
            
            // Create the Model Accuracy Chart for Methodology
            if (document.getElementById('modelAccuracyChart')) {
                const modelAccuracyCtx = document.getElementById('modelAccuracyChart').getContext('2d');
                const modelAccuracyChart = new Chart(modelAccuracyCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Linear Regression', 'Decision Tree', 'Random Forest', 'Gradient Boosting', 'Neural Network'],
                        datasets: [{
                            label: 'Prediction Accuracy (%)',
                            data: [67, 78, 91, 89, 83],
                            backgroundColor: 'rgba(0, 119, 182, 0.8)',
                            borderColor: 'rgba(0, 119, 182, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                title: {
                                    display: true,
                                    text: 'Accuracy (%)'
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Model Type'
                                }
                            }
                        },
                        plugins: {
                            title: {
                                display: true,
                                text: 'Prediction Model Accuracy Comparison'
                            }
                        }
                    }
                });
            }
            
            // Create the Fuel Savings Chart for Methodology
            if (document.getElementById('fuelSavingsChart')) {
                const fuelSavingsCtx = document.getElementById('fuelSavingsChart').getContext('2d');
                const fuelSavingsChart = new Chart(fuelSavingsCtx, {
                    type: 'line',
                    data: {
                        labels: ['Q1', 'Q2', 'Q3', 'Q4', 'Q1', 'Q2'],
                        datasets: [
                            {
                                label: 'Fixed Schedule Cleaning',
                                data: [0, 7, 4, 9, 2, 8],
                                fill: false,
                                borderColor: 'rgba(220, 53, 69, 1)',
                                tension: 0.1
                            },
                            {
                                label: 'Model-Based Cleaning',
                                data: [0, 2, 1, 3, 1, 2],
                                fill: false,
                                borderColor: 'rgba(40, 167, 69, 1)',
                                tension: 0.1
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Fuel Consumption Increase (%)'
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Time Period (Quarters)'
                                }
                            }
                        },
                        plugins: {
                            title: {
                                display: true,
                                text: 'Fuel Consumption Increase Due to Hull Fouling'
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return context.dataset.label + ': ' + context.parsed.y + '% increase';
                                    }
                                }
                            }
                        }
                    }
                });
            }
        });

        // Function to show the ship detail view
        function showShipDetail(shipName) {
            document.getElementById('dashboard-view').style.display = 'none';
            document.getElementById('methodology-view').style.display = 'none';
            document.getElementById('ship-detail-view').style.display = 'block';
            document.getElementById('vessel-name').textContent = shipName;
            
            // Initialize the vessel map when the detail view is shown
            setTimeout(() => {
                initVesselMap();
            }, 100);
        }
        
        // Function to return to dashboard
        function showDashboard() {
            document.getElementById('dashboard-view').style.display = 'block';
            document.getElementById('ship-detail-view').style.display = 'none';
            document.getElementById('methodology-view').style.display = 'none';
        }
        
        // Function to show methodology view
        function showMethodology() {
            document.getElementById('dashboard-view').style.display = 'none';
            document.getElementById('ship-detail-view').style.display = 'none';
            document.getElementById('methodology-view').style.display = 'block';
            
            // Initialize the charts if they haven't been created yet
            setTimeout(() => {
                if (document.getElementById('modelAccuracyChart') && !document.getElementById('modelAccuracyChart').chart) {
                    const modelAccuracyCtx = document.getElementById('modelAccuracyChart').getContext('2d');
                    const modelAccuracyChart = new Chart(modelAccuracyCtx, {
                        type: 'bar',
                        data: {
                            labels: ['Linear Regression', 'Decision Tree', 'Random Forest', 'Gradient Boosting', 'Neural Network'],
                            datasets: [{
                                label: 'Prediction Accuracy (%)',
                                data: [67, 78, 91, 89, 83],
                                backgroundColor: 'rgba(0, 119, 182, 0.8)',
                                borderColor: 'rgba(0, 119, 182, 1)',
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    max: 100,
                                    title: {
                                        display: true,
                                        text: 'Accuracy (%)'
                                    }
                                },
                                x: {
                                    title: {
                                        display: true,
                                        text: 'Model Type'
                                    }
                                }
                            },
                            plugins: {
                                title: {
                                    display: true,
                                    text: 'Prediction Model Accuracy Comparison'
                                }
                            }
                        }
                    });
                    
                    const fuelSavingsCtx = document.getElementById('fuelSavingsChart').getContext('2d');
                    const fuelSavingsChart = new Chart(fuelSavingsCtx, {
                        type: 'line',
                        data: {
                            labels: ['Q1', 'Q2', 'Q3', 'Q4', 'Q1', 'Q2'],
                            datasets: [
                                {
                                    label: 'Fixed Schedule Cleaning',
                                    data: [0, 7, 4, 9, 2, 8],
                                    fill: false,
                                    borderColor: 'rgba(220, 53, 69, 1)',
                                    tension: 0.1
                                },
                                {
                                    label: 'Model-Based Cleaning',
                                    data: [0, 2, 1, 3, 1, 2],
                                    fill: false,
                                    borderColor: 'rgba(40, 167, 69, 1)',
                                    tension: 0.1
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    title: {
                                        display: true,
                                        text: 'Fuel Consumption Increase (%)'
                                    }
                                },
                                x: {
                                    title: {
                                        display: true,
                                        text: 'Time Period (Quarters)'
                                    }
                                }
                            },
                            plugins: {
                                title: {
                                    display: true,
                                    text: 'Fuel Consumption Increase Due to Hull Fouling'
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            return context.dataset.label + ': ' + context.parsed.y + '% increase';
                                        }
                                    }
                                }
                            }
                        }
                    });
                }
            }, 100);
        }
        
        // Function to show specific port details
        function showPortDetail(portName) {
            // Find the port data
            const port = portsData.find(p => p.name === portName);
            if (!port) return;
            
            // Switch to ship detail view and simulate selecting this port
            showShipDetail('OCEANIC VOYAGER');
            
            // Select the port in the port selector
            document.querySelectorAll('.port-option').forEach(el => {
                if (el.textContent === portName) {
                    selectPort(el, portName);
                }
            });
        }
        
        // Function to handle port selection
        function selectPort(element, portName) {
            // Remove selected class from all port options
            document.querySelectorAll('.port-option').forEach(el => {
                el.classList.remove('selected');
            });
            
            // Add selected class to clicked element
            element.classList.add('selected');
            
            // Get port requirements data
            const requirements = portRequirements[portName] || portRequirements["Singapore"];
            
            // Update port info
            document.getElementById('selected-port-name').textContent = portName;
            document.getElementById('selected-port-biosecurity').textContent = requirements.biosecurityLevel;
            document.getElementById('selected-port-max-risk').textContent = requirements.maxRiskScore.toFixed(1);
            document.getElementById('selected-port-max-days').textContent = requirements.maxDaysSinceCleaning + " days";
            
            // Update the port requirements in the compliance section
            document.getElementById('port-risk-threshold').textContent = requirements.maxRiskScore.toFixed(1);
            document.getElementById('port-cleaning-days').textContent = requirements.maxDaysSinceCleaning;
            
            // Update pass/fail status based on the selected port
            updateComplianceStatus(requirements);
        }
        
        // Function to update compliance status based on selected port requirements
        function updateComplianceStatus(requirements) {
            const shipRiskScore = 42.8;
            const shipCleaningDays = 85;
            
            // Risk score requirement
            const riskScoreRequirement = document.querySelector('.requirement-status:nth-child(2)');
            const riskScoreExcess = shipRiskScore - requirements.maxRiskScore;
            
            if (shipRiskScore <= requirements.maxRiskScore) {
                riskScoreRequirement.innerHTML = `<i class="fas fa-check-circle"></i> ${shipRiskScore.toFixed(1)} (Compliant)`;
                riskScoreRequirement.classList.remove('fail');
                riskScoreRequirement.classList.add('pass');
            } else {
                riskScoreRequirement.innerHTML = `<i class="fas fa-times-circle"></i> ${shipRiskScore.toFixed(1)} (Exceeds by ${riskScoreExcess.toFixed(1)})`;
                riskScoreRequirement.classList.remove('pass');
                riskScoreRequirement.classList.add('fail');
            }
            
            // Cleaning days requirement
            const cleaningRequirement = document.querySelector('.requirement-status:nth-child(2)');
            const cleaningExcess = shipCleaningDays - requirements.maxDaysSinceCleaning;
            
            if (shipCleaningDays <= requirements.maxDaysSinceCleaning) {
                cleaningRequirement.innerHTML = `<i class="fas fa-check-circle"></i> ${shipCleaningDays} days (Compliant)`;
                cleaningRequirement.classList.remove('fail');
                cleaningRequirement.classList.add('pass');
            } else {
                cleaningRequirement.innerHTML = `<i class="fas fa-times-circle"></i> ${shipCleaningDays} days (Exceeds by ${cleaningExcess} days)`;
                cleaningRequirement.classList.remove('pass');
                cleaningRequirement.classList.add('fail');
            }
            
            // Update recommendations based on the selected port
            updateRecommendations(requirements, portName);
        }
        
        // Function to update recommendations based on selected port
        function updateRecommendations(requirements, portName) {
            const recommendationsContainer = document.querySelector('.card:last-child');
            const shipRiskScore = 42.8;
            const shipCleaningDays = 85;
            
            let recommendationsHTML = `<div class="panel-title">Recommendations</div>`;
            
            if (shipRiskScore > requirements.maxRiskScore) {
                recommendationsHTML += `
                    <div class="recommendation-card red">
                        <div class="recommendation-title">Risk Score Too High for ${portName}</div>
                        <div>Vessel risk score (${shipRiskScore.toFixed(1)}) exceeds ${portName}'s maximum allowable score (${requirements.maxRiskScore.toFixed(1)}). Consider hull cleaning or maintenance before arrival.</div>
                    </div>
                `;
            }
            
            if (shipCleaningDays > requirements.maxDaysSinceCleaning) {
                recommendationsHTML += `
                    <div class="recommendation-card ${shipRiskScore > requirements.maxRiskScore ? 'yellow' : 'red'}">
                        <div class="recommendation-title">Hull Cleaning Required</div>
                        <div>Last hull cleaning (${shipCleaningDays} days ago) exceeds ${portName}'s requirement of ${requirements.maxDaysSinceCleaning} days. Schedule hull cleaning before arrival.</div>
                    </div>
                `;
            }
            
            recommendationsHTML += `
                <div class="recommendation-card yellow">
                    <div class="recommendation-title">Submit Biofouling Management Plan</div>
                    <div>Prepare and submit a detailed biofouling management plan to ${portName} port authorities, documenting all maintenance and risk mitigation measures.</div>
                </div>
            `;
            
            if (requirements.biosecurityLevel === "Strict" || requirements.biosecurityLevel === "Very Strict") {
                recommendationsHTML += `
                    <div class="recommendation-card yellow">
                        <div class="recommendation-title">Special Inspection May Be Required</div>
                        <div>${portName} has a ${requirements.biosecurityLevel.toLowerCase()} biosecurity level. Consider arranging for a pre-arrival inspection to facilitate entry approval.</div>
                    </div>
                `;
            }
            
            recommendationsContainer.innerHTML = recommendationsHTML;
        }
    </script>
</body>
</html>